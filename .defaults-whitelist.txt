# No-Defaults Linter Whitelist (Structural)
#
# Format: <filepath>::<class>::<function>::<variable>:<rule_id>
# Use * for wildcards, ** for path components
#
# This uses STRUCTURAL patterns instead of line-based patterns.
# Benefits:
#   - Stable across refactors (doesn't break when code moves)
#   - More semantic (whitelist whole classes/modules)
#   - Easier to maintain (20 patterns vs 278 line numbers)
#
# Generated: 2025-11-04
# Replaces: 278 line-based entries with ~20 structural patterns
#

# ============================================================================
# MODULE-LEVEL WHITELISTS
# ============================================================================
# Whitelist entire modules that are legacy/temporary

# Demo/Runner - Temporary entry point, extensive dict.get usage
# Will be replaced by TASK-003 DTOs and moved to townlet/training/
src/townlet/demo/**:*

# Recording - Optional feature system, some defaults acceptable
src/townlet/recording/**:*

# ============================================================================
# FILE-LEVEL WHITELISTS
# ============================================================================
# Whitelist entire files that need refactoring

# Legacy agent networks - will be replaced by BRAIN_AS_CODE (TASK-005)
src/townlet/agent/networks.py:*

# Curriculum - will be config-driven in TASK-004A
src/townlet/curriculum/adversarial.py:*
src/townlet/curriculum/static.py:*

# TensorBoard logger - telemetry system, many dict.get calls
src/townlet/training/tensorboard_logger.py:*

# ============================================================================
# CLASS-LEVEL WHITELISTS
# ============================================================================
# Whitelist specific classes that have acceptable defaults

# Environment modules - will be refactored in TASK-003/TASK-004A
src/townlet/environment/affordance_config.py:*
src/townlet/environment/affordance_engine.py:*
src/townlet/environment/cascade_config.py:*
src/townlet/environment/cascade_engine.py:*
src/townlet/environment/meter_dynamics.py:*
src/townlet/environment/observation_builder.py:*
src/townlet/environment/reward_strategy.py:*
src/townlet/environment/vectorized_env.py:*

# Action Labels for Substrate
src/townlet/environment/action_labels.py:*
src/townlet/substrate/**:*

# ActionConfig and ActionSpaceBuilder - INTERNAL fields only
# Behavioral fields (costs, effects) have NO defaults (operator must specify)
# Metadata fields (delta, teleport_to, icon, description, source_affordance) use None as STRUCTURAL defaults
# enabled is INTERNAL (computed by builder, not from config)
# VFS fields (reads, writes) default to empty lists for backward compatibility during Phase 1
src/townlet/environment/action_config.py:ActionConfig:*:delta:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:teleport_to:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:description:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:icon:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:source:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:source_affordance:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:reads:CALL003
src/townlet/environment/action_config.py:ActionConfig:*:writes:CALL003
src/townlet/environment/action_builder.py:ActionSpaceBuilder:__init__:enabled_action_names:DEF001

# Exploration - will be config-driven in BRAIN_AS_CODE (TASK-005)
src/townlet/exploration/**:*

# Population - will use config DTOs in TASK-003
src/townlet/population/**:*

# Training infrastructure - will use DTOs in TASK-003
src/townlet/training/replay_buffer.py:*
src/townlet/training/sequential_replay_buffer.py:*

# State DTOs - some defaults are metadata (acceptable per no-defaults principle)
src/townlet/training/state.py:*

# VFS (Variable & Feature System) - Phase 1 schemas
# Optional/metadata fields with acceptable defaults per no-defaults principle:
#   - NormalizationSpec: min/max/mean/std are optional (kind determines which are used)
#   - ObservationField: normalization is optional (None = no normalization)
#   - VariableDef: dims optional (only for vecNi/vecNf), description optional (metadata)
src/townlet/vfs/schema.py:NormalizationSpec:*:min:CALL003
src/townlet/vfs/schema.py:NormalizationSpec:*:max:CALL003
src/townlet/vfs/schema.py:NormalizationSpec:*:mean:CALL003
src/townlet/vfs/schema.py:NormalizationSpec:*:std:CALL003
src/townlet/vfs/schema.py:ObservationField:*:normalization:CALL003
src/townlet/vfs/schema.py:VariableDef:*:dims:CALL003
src/townlet/vfs/schema.py:VariableDef:*:description:CALL003

# Needs review
src/townlet/vfs/observation_builder.py:*
src/townlet/vfs/registry.py:*
src/townlet/config/base.py:*
src/townlet/config/cues.py:*
src/townlet/config/hamlet.py:*
src/townlet/universe/dto/action_metadata.py:*
src/townlet/universe/dto/affordance_metadata.py:*
src/townlet/universe/dto/meter_metadata.py:*
src/townlet/universe/dto/observation_spec.py:*
src/townlet/config/training.py:*
src/townlet/compiler/__main__.py:*
src/townlet/config/affordance.py:*
src/townlet/config/effect_pipeline.py:*
src/townlet/environment/action_config.py:*
src/townlet/environment/substrate_action_validator.py:*
src/townlet/training/checkpoint_utils.py:*
src/townlet/universe/adapters/vfs_adapter.py:*
src/townlet/universe/compiled.py:*
src/townlet/universe/compiler.py:*
src/townlet/universe/dto/universe_metadata.py:*
src/townlet/universe/errors.py:*
src/townlet/universe/optimization.py:*
src/townlet/universe/source_map.py:*
src/townlet/universe/symbol_table.py:*
src/townlet/vfs/schema.py:*
src/townlet/universe/compiler_inputs.py:*
src/townlet/config/capability_config.py:*

# Drive As Code (DAC) - TASK-004C
# ExtrinsicStrategyConfig: Optional fields (base, bars, bar_bonuses, variable_bonuses, etc.)
#   - Strategy-specific fields default to None (each strategy uses different subset)
#   - Operator must specify fields relevant to chosen strategy type
# IntrinsicStrategyConfig: apply_modifiers defaults to [] (no modifiers applied)
# DriveAsCodeConfig: shaping defaults to [] (no shaping bonuses)
# DACEngine: Runtime defaults for optional strategy fields (base, bar_bonuses, etc.)
#   - Ternary expressions provide sensible defaults when YAML omits optional fields
#   - dict.get() for kwargs (shaping bonuses receive context as needed)
src/townlet/config/drive_as_code.py:*
src/townlet/environment/dac_engine.py:*

# ============================================================================
# EXCEPTIONAL LINE-BASED WHITELISTS
# ============================================================================
# Use line-based patterns ONLY for one-off exceptions that don't fit structural patterns

# VFS Phase 1 - ActionConfig VFS integration fields (backward compatibility)
src/townlet/environment/action_config.py:68:CALL003
src/townlet/environment/action_config.py:72:CALL003

# VFS Phase 1 - Schema optional/metadata fields
src/townlet/vfs/schema.py:44:CALL003
src/townlet/vfs/schema.py:48:CALL003
src/townlet/vfs/schema.py:54:CALL003
src/townlet/vfs/schema.py:58:CALL003
src/townlet/vfs/schema.py:150:CALL003
src/townlet/vfs/schema.py:212:CALL003
src/townlet/vfs/schema.py:236:CALL003

# ============================================================================
# TEMPORARY - Will be removed by TASK-003 and TASK-004A
# ============================================================================
#
# Most of these whitelisted patterns exist because:
#   1. Config loading uses dict.get() instead of Pydantic DTOs (TASK-003)
#   2. Affordance system has hardcoded defaults (TASK-004A)
#   3. Runner is temporary entry point (will move to townlet/training/)
#   4. Exploration/curriculum not yet config-driven (TASK-005)
#
# NEXT STEPS:
# 1. TASK-003: Replace dict.get() with Pydantic DTOs (no-defaults principle)
# 2. TASK-004A: Universe compiler validates all config
# 3. Move runner to townlet/training/, use DTOs
# 4. TASK-005: Make networks/exploration config-driven (BRAIN_AS_CODE)
# 5. Remove most entries from this whitelist
#
# Track progress: python scripts/no_defaults_lint.py src/townlet/ --whitelist .defaults-whitelist.txt
#
