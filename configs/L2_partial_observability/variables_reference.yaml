# Variable & Feature System (VFS) Configuration - REQUIRED
# Config: L2_partial_observability (8×8 Grid2D, POMDP with 5×5 vision window)
#
# Purpose: Defines observation space for reinforcement learning
#   - Variables: State components (position, meters, affordances, temporal)
#   - Observations: What agents see (exposures with normalization)
#   - Shapes: Explicit dimensionality for network architecture
#
# Status: REQUIRED (not temporary) - part of VFS integration (TASK-002C)
# Impact: Changes to this file affect observation dimensions → breaks checkpoints
# DO NOT MODIFY without understanding checkpoint compatibility implications

version: "1.0"

variables:
  # POMDP local window: 25 cells (5×5)
  - {id: "local_window", scope: "agent", type: "vecNf", dims: 25, lifetime: "tick", readable_by: ["agent"], writable_by: ["engine"], default: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}

  # Full observability grid encoding: 64 cells (8×8) - NOT used in POMDP mode
  # NOTE: Not readable by agent in L2 (POMDP mode), only readable by engine for internal use
  - {id: "grid_encoding", scope: "agent", type: "vecNf", dims: 64, lifetime: "tick", readable_by: ["engine"], writable_by: ["engine"], default: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}

  # Normalized position: 2 dims
  - {id: "position", scope: "agent", type: "vecNf", dims: 2, lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: [0,0]}

  # Meters: 8 scalars
  - {id: "energy", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "health", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "satiation", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "money", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 0.0}
  - {id: "mood", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "social", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "fitness", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "hygiene", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}

  # Affordance: 15 dims
  - {id: "affordance_at_position", scope: "agent", type: "vecNf", dims: 15, lifetime: "tick", readable_by: ["agent"], writable_by: ["engine"], default: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]}

  # Temporal: 4 scalars
  - {id: "time_sin", scope: "global", type: "scalar", lifetime: "tick", readable_by: ["agent"], writable_by: ["engine"], default: 0.0}
  - {id: "time_cos", scope: "global", type: "scalar", lifetime: "tick", readable_by: ["agent"], writable_by: ["engine"], default: 1.0}
  - {id: "interaction_progress", scope: "agent", type: "scalar", lifetime: "tick", readable_by: ["agent"], writable_by: ["engine"], default: 0.0}
  - {id: "lifetime_progress", scope: "agent", type: "scalar", lifetime: "episode", readable_by: ["agent"], writable_by: ["engine"], default: 0.0}

exposed_observations:
  - {id: "obs_local_window", source_variable: "local_window", exposed_to: ["agent"], shape: [25]}
  # NOTE: obs_grid_encoding not exposed for POMDP mode (L2 always uses partial_observability=true)
  - {id: "obs_pos", source_variable: "position", exposed_to: ["agent"], shape: [2]}
  - {id: "obs_energy", source_variable: "energy", exposed_to: ["agent"], shape: []}
  - {id: "obs_health", source_variable: "health", exposed_to: ["agent"], shape: []}
  - {id: "obs_satiation", source_variable: "satiation", exposed_to: ["agent"], shape: []}
  - {id: "obs_money", source_variable: "money", exposed_to: ["agent"], shape: []}
  - {id: "obs_mood", source_variable: "mood", exposed_to: ["agent"], shape: []}
  - {id: "obs_social", source_variable: "social", exposed_to: ["agent"], shape: []}
  - {id: "obs_fitness", source_variable: "fitness", exposed_to: ["agent"], shape: []}
  - {id: "obs_hygiene", source_variable: "hygiene", exposed_to: ["agent"], shape: []}
  - {id: "obs_affordance", source_variable: "affordance_at_position", exposed_to: ["agent"], shape: [15]}
  - {id: "obs_time_sin", source_variable: "time_sin", exposed_to: ["agent"], shape: []}
  - {id: "obs_time_cos", source_variable: "time_cos", exposed_to: ["agent"], shape: []}
  - {id: "obs_interaction_progress", source_variable: "interaction_progress", exposed_to: ["agent"], shape: []}
  - {id: "obs_lifetime_progress", source_variable: "lifetime_progress", exposed_to: ["agent"], shape: []}

# Dimension validation: 25 + 2 + 8 + 15 + 4 = 54 dims
